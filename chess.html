<html>
<head>
<style>
#body {
background-color: rgb(150 , 150 , 0);
}
#last {
margin: auto;
width: 400px;
}
.blac.circle {
background-color: black;
width: 50px;
height: 50px;
border-radius: 50%;
margin: auto;
}
.whit.circle {
background-color: white;
width: 50px;
height: 50px;
border-radius: 50%;
margin: auto;
}
.whit.queen {
width: 0px;
height: 0px;
margin: auto;
border-top: 25px solid transparent;
border-left: 25px solid white;
border-right: 25px solid white;
border-bottom: 25px solid white;
}
.blac.queen {
width: 0px;
height: 0px;
margin: auto;
border-top: 25px solid transparent;
border-left: 25px solid black;
border-right: 25px solid black;
border-bottom: 25px solid black;
}
.empty {
background-color: transparent;
}
.whit.horse {
height: 20px;
width: 50px;
background-color: white;
}
.blac.horse {
height: 20px;
width: 50px;
background-color: black;
}
.blac.horse2 {
width: 30px;
height: 50px;
position: relative;
left: 15px;
background-color: black;
}
.whit.horse2 {
width: 30px;
height: 50px;
position: relative;
left: 15px;
background-color: white;
}
.king {
width: 40px;
height: 15px;
position: relative;
top: 10px;
right: 12.5px;
background-color: white;
}

.blac.king {
width: 40px;
height: 15px;
position: relative;
top: 10px;
right: 12.5px;
background-color: black;
}

.blac.king2 {
width: 15px;
height: 50px;
margin: auto;
background-color: black;
}

.whit.king2 {
width: 15px;
height: 50px;
margin: auto;
background-color: white;
}

.blac.triangle {
width: 0px;
height: 0px;
margin: auto;
border-left: 30px solid transparent;
border-right: 30px solid transparent;
border-bottom: 50px solid black;
}
.whit.triangle {
width: 0px;
height: 0px;
margin: auto;
border-left: 30px solid transparent;
border-right: 30px solid transparent;
border-bottom: 50px solid white;
}
.blac.rook {
width: 0px;
height: 0px;
margin: auto;
border-top: 25px solid black;
border-bottom: 25px solid black;
border-left: 25px solid transparent;
border-right: 25px solid transparent;
}

.whit.rook {
width: 0px;
height: 0px;
margin: auto;
border-top: 25px solid white;
border-bottom: 25px solid white;
border-left: 25px solid transparent;
border-right: 25px solid transparent;
}
.whit.rook2 {
width: 20px;
height: 20px;
margin:-10px;
background-color: white;
}
.blac.rook2 {
width: 20px;
height: 20px;
margin:-10px;
background-color: black;
}
.chess {
width: 80px;
height: 80px;

}
#board {
margin: auto;
border: 5px solid gray;
}
.black {
background-color: rgb(160 , 160 , 160);
}
.white {
background-color: rgb(40 , 40 , 40);
}

</style>
</head>
<body id="body">
<table id="board" border="1">
<tr>
<td onclick="select(this)" class="black chess" id="a1">
<div class="blac rook bruh"><div class="blac rook2"></div></div>
</td>
<td onclick="select(this)" class="white chess" id="a2">
<div class="blac horse2"><div class="blac horse"></div></div>
</td>
<td onclick="select(this)" class="black chess" id="a3">
<div class="blac triangle"></div>
</td>
<td onclick="select(this)" class="white chess" id="a4">
<div class="blac queen"></div>
</td>
<td onclick="select(this)" class="black chess" id="a5">
<div class="blac king2 rruh"><div class="blac king"></div></div>
</td>
<td onclick="select(this)" class="white chess" id="a6">
<div class="blac triangle"></div>
</td>
<td onclick="select(this)" class="black chess" id="a7">
<div class="blac horse2"><div class="blac horse"></div></div>
</td>
<td onclick="select(this)" class="white chess" id="a8">
<div class="blac rook bruh"><div class="blac rook2"></div></div>
</td>
</tr>
<tr>
<td onclick="select(this)" class="white chess" id="b1">
<div class="blac circle"></div>
</td>
<td onclick="select(this)" class="black chess" id="b2">
<div class="blac circle"></div>
</td>
<td onclick="select(this)" class="white chess" id="b3">
<div class="blac circle"></div>
</td>
<td class="black chess" onclick="select(this)" id="b4">
<div class="blac circle"></div>
</td>
<td onclick="select(this)" class="white chess" id="b5">
<div class="blac circle"></div>
</td>
<td onclick="select(this)" class="black chess" id="b6">
<div class="blac circle"></div>
</td>
<td onclick="select(this)" class="white chess" id="b7">
<div class="blac circle"></div>
</td>
<td onclick="select(this)" class="black chess" id="b8">
<div class="blac circle"></div>
</td>
</tr>
<tr>
<td onclick="select(this)" class="black chess" id="c1">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="c2">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="c3">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="c4">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="c5">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="c6">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="c7">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="c8">
<div class="empty">
</td>
</tr>
<tr>
<td onclick="select(this)" class="white chess" id="d1">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="d2">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="d3">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="d4">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="d5">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="d6">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="d7">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="d8">
<div class="empty">
</td>
</tr>

<tr>
<td onclick="select(this)" class="black chess" id="e1">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="e2">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="e3">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="e4">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="e5">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="e6">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="e7">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="e8">
<div class="empty">
</td>
</tr>
<tr>
<td onclick="select(this)" class="white chess" id="f1">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="f2">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="f3">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="f4">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="f5">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="f6">
<div class="empty">
</td>
<td onclick="select(this)" class="white chess" id="f7">
<div class="empty">
</td>
<td onclick="select(this)" class="black chess" id="f8">
<div class="empty">
</td>
</tr>
<tr>
<td onclick="select(this)" class="black chess" id="g1">
<div class="whit circle"></div>
</td>
<td onclick="select(this)" class="white chess" id="g2">
<div class="whit circle"></div>
</td>
<td onclick="select(this)" class="black chess" id="g3">
<div class="whit circle"></div>
</td>
<td onclick="select(this)" class="white chess" id="g4">
<div class="whit circle"></div>
</td>
<td onclick="select(this)" class="black chess" id="g5">
<div class="whit circle"></div>
</td>
<td onclick="select(this)" class="white chess" id="g6">
<div class="whit circle"></div>
</td>
<td onclick="select(this)" class="black chess" id="g7">
<div class="whit circle"></div>
</td>
<td onclick="select(this)" class="white chess" id="g8">
<div class="whit circle"></div>
</td>
</tr>
<tr>
<td onclick="select(this)" class="white chess" id="h1">
<div class="whit rook bruh"><div class="whit rook2 bruh"></div></div>
</td>
<td onclick="select(this)" class="black chess" id="h2">
<div class="whit horse2"><div class="whit horse"></div></div>
</td>
<td onclick="select(this)" class="white chess" id="h3">
<div class="whit triangle"></div>
</td>
<td onclick="select(this)" class="black chess" id="h4">
<div class="whit queen"></div>
</td>
<td onclick="select(this)" class="white chess" id="h5">
<div class="whit king2 rruh"><div class="whit king"></div></div>
</td>
<td onclick="select(this)" class="black chess" id="h6">
<div class="whit triangle"></div>
</td>
<td onclick="select(this)" class="white chess" id="h7">
<div class="whit horse2"><div class="whit horse"></div></div>
</td>
<td onclick="select(this)" class="black chess" id="h8">
<div class="whit rook bruh"><div class="whit rook2 bruh"></div></div>
</td>
</tr>
<table id="last">
<tr>
<td id="replace1"></td>
<td id="replace2"></td>
<td id="replace3"></td>
<td id="replace4"></td>
</tr>
</table>
<script>
ip = <FILL>
id = <FILL>
your_color = <FILL>
turn = <FILL>
if (your_color == "whit") {
ennemy_color = "blac"
}
else {
ennemy_color = "whit"
}
board = document.getElementById("board")
board.style.transform = 'rotate(<FILL>deg)'
Array.from(document.getElementsByClassName("chess")).forEach(function (item) {item.style.transform = "rotate(<FILL>deg)"})
let2num = ["x", "a", "b", "c", "d", "e", "f", "g", "h", "y"]
function query_case(clicked_element) {
if (clicked_element.className.split(" ")[1] == "chess") {
return clicked_element
}
else if (clicked_element.className.split(" ")[0] == "whit" || clicked_element.className.split(" ")[0] == "blac") {
return clicked_element.parentNode
}
else {
return "null"
}
}

function move(initial) {
destination = query_case(event.target)
if (destination.style.border == "5px solid green") {
destination.innerHTML = initial.innerHTML
initial.innerHTML = "<div class='empty'>"
destination.children[0].className = "pseudo " + destination.children[0].className
req2 = new XMLHttpRequest()
req2.open("POST", ip)
req2.onload = function() {
j = "n"
}
req2.send(["played%" + id + "%" + initial.id + "->" + destination.id])
turn = "his_turn"
} 
}

function show_possible_movements(initial){
//pawn
if (initial.children[0].className == your_color + " circle") {
minus_plus = 1
if (your_color == "blac") {minus_plus = -1}
if (document.getElementById(let2num[let2num.indexOf(initial.id[0]) - 1*minus_plus] + initial.id[1]).children[0].className.split(" ")[0] != your_color) {
document.getElementById(let2num[let2num.indexOf(initial.id[0]) - minus_plus] + initial.id[1]).style.border = "5px solid green"
}
if ((your_color == "whit" && initial.id[0] == "g" && document.getElementById(let2num[let2num.indexOf(initial.id[0]) - 2*minus_plus] + initial.id[1]).children[0].className.split(" ")[0] != your_color) || (your_color == "blac" && initial.id[0] == "b")) {
document.getElementById(let2num[let2num.indexOf(initial.id[0]) - 2*minus_plus] + initial.id[1]).style.border = "5px solid green"
}
if (document.getElementById(let2num[let2num.indexOf(initial.id[0]) - 1*minus_plus] + (parseInt(initial.id[1]) + 1)) != null  && document.getElementById(let2num[let2num.indexOf(initial.id[0]) - 1*minus_plus] + (parseInt(initial.id[1]) + 1)).children[0].className.split(" ")[0] == ennemy_color) {
document.getElementById(let2num[let2num.indexOf(initial.id[0]) - 1*minus_plus] + (parseInt(initial.id[1]) + 1)).style.border = "5px solid green"
} 
if (document.getElementById(let2num[let2num.indexOf(initial.id[0]) - 1*minus_plus] + (parseInt(initial.id[1]) - 1)) != null  && document.getElementById(let2num[let2num.indexOf(initial.id[0]) - 1*minus_plus] + (parseInt(initial.id[1]) - 1)).children[0].className.split(" ")[0] == ennemy_color) {
document.getElementById(let2num[let2num.indexOf(initial.id[0]) - 1*minus_plus] + (parseInt(initial.id[1]) - 1)).style.border = "5px solid green"
} 
}
//pawn//
//king
if (initial.children[0].className.split(" ")[0] + " " + initial.children[0].className.split(" ")[1] == your_color + " king2") {
case_ids = []
case_ids.push(let2num[let2num.indexOf(initial.id[0]) + 1] + ""  + parseInt(initial.id[1]))
case_ids.push(let2num[let2num.indexOf(initial.id[0]) - 1] + ""  + parseInt(initial.id[1]))
case_ids.push(let2num[let2num.indexOf(initial.id[0])] + ""  + (parseInt(initial.id[1]) + 1))
case_ids.push(let2num[let2num.indexOf(initial.id[0])] + ""  + (parseInt(initial.id[1]) - 1))
case_ids.push(let2num[let2num.indexOf(initial.id[0]) + 1] + "" + (parseInt(initial.id[1]) + 1))
case_ids.push(let2num[let2num.indexOf(initial.id[0]) - 1] + "" + (parseInt(initial.id[1]) + 1))
case_ids.push(let2num[let2num.indexOf(initial.id[0]) + 1] + "" + (parseInt(initial.id[1]) - 1))
case_ids.push(let2num[let2num.indexOf(initial.id[0]) - 1] + "" + (parseInt(initial.id[1]) - 1)) 
case_ids.forEach((case_id) => {
if (document.getElementById(case_id) != null) {
document.getElementById(case_id).style.border = "5px solid green"
}
})
}
//king//
//horse
if (initial.children[0].className == your_color + " horse2") {
case_ids = []
case_ids.push(let2num[let2num.indexOf(initial.id[0]) + 2] + "" + (parseInt(initial.id[1]) + 1))
case_ids.push(let2num[let2num.indexOf(initial.id[0]) + 2] + "" + (parseInt(initial.id[1]) - 1))
case_ids.push(let2num[let2num.indexOf(initial.id[0]) - 2] + "" + (parseInt(initial.id[1]) + 1))
case_ids.push(let2num[let2num.indexOf(initial.id[0]) - 2] + "" + (parseInt(initial.id[1]) - 1))
case_ids.push(let2num[let2num.indexOf(initial.id[0]) + 1] + "" + (parseInt(initial.id[1]) - 2))
case_ids.push(let2num[let2num.indexOf(initial.id[0]) + 1] + "" + (parseInt(initial.id[1]) + 2))
case_ids.push(let2num[let2num.indexOf(initial.id[0]) - 1] + "" + (parseInt(initial.id[1]) - 2))
case_ids.push(let2num[let2num.indexOf(initial.id[0]) - 1] + "" + (parseInt(initial.id[1]) + 2))
case_ids.forEach((case_id) => {
if (document.getElementById(case_id) != null && document.getElementById(case_id).children[0].className.split(" ")[0] != your_color) {
document.getElementById(case_id).style.border = "5px solid green"
}
})
}
//horse//
//rook
if (initial.children[0].className.split(" ")[0] + " " + initial.children[0].className.split(" ")[1] == your_color + " rook") {
var check = 1;
var move_right = parseInt(initial.id[1]);
while (move_right < 8 && check == 1) {
move_right++;
var selection = document.getElementById(initial.id[0] + move_right);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}


var check = 1;
var move_left = parseInt(initial.id[1]);
while (move_left > 1 && check == 1) {
move_left--;
var selection = document.getElementById(initial.id[0] + move_left);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}


var check = 1;
var move_top = let2num.indexOf(initial.id[0]);
while (move_top < 8 && check == 1) {
move_top++;
var selection = document.getElementById(let2num[move_top] + initial.id[1]);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}

var check = 1;
var move_bot = let2num.indexOf(initial.id[0]);
while (move_bot > 1 && check == 1) {
move_bot--;
var selection = document.getElementById(let2num[move_bot] + initial.id[1]);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}

}
//rook//
//bishop
if (initial.children[0].className == your_color + " triangle") {
var check = 1;
var move_right1 = parseInt(initial.id[1]);
var move_bot1 = let2num.indexOf(initial.id[0]);
while (move_right1 < 8 && move_bot1 > 1 && check == 1) {
move_right1++;
move_bot1--;
var selection = document.getElementById(let2num[move_bot1] + move_right1);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}

var check = 1;
var move_right2 = parseInt(initial.id[1]);
var move_top1 = let2num.indexOf(initial.id[0]);
while (move_right2 < 8 && move_top1 < 8 && check == 1) {
move_right2++;
move_top1++;
var selection = document.getElementById(let2num[move_top1] + move_right2);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}



var check = 1;
var move_left1 = parseInt(initial.id[1]);
var move_bot2 = let2num.indexOf(initial.id[0]);
while (move_left1 > 1 && move_bot2 > 1 && check == 1) {
move_left1--;
move_bot2--;
var selection = document.getElementById(let2num[move_bot2] + move_left1);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}

var check = 1;
var move_left2 = parseInt(initial.id[1]);
var move_top2 = let2num.indexOf(initial.id[0]);
while (move_left2 > 1 && move_top2 < 8 && check == 1) {
move_left2--;
move_top2++;
var selection = document.getElementById(let2num[move_top2] + move_left2);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}

}
//bishop//
//queen
if (initial.children[0].className == your_color + " queen") {
var check = 1;
var move_right = parseInt(initial.id[1]);
while (move_right < 8 && check == 1) {
move_right++;
var selection = document.getElementById(initial.id[0] + move_right);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else {
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}


var check = 1;
var move_left = parseInt(initial.id[1]);
while (move_left > 1 && check == 1) {
move_left--;
var selection = document.getElementById(initial.id[0] + move_left);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}


var check = 1;
var move_top = let2num.indexOf(initial.id[0]);
while (move_top < 8 && check == 1) {
move_top++;
var selection = document.getElementById(let2num[move_top] + initial.id[1]);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}

var check = 1;
var move_bot = let2num.indexOf(initial.id[0]);
while (move_bot > 1 && check == 1) {
move_bot--;
var selection = document.getElementById(let2num[move_bot] + initial.id[1]);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}


var check = 1;
var move_right1 = parseInt(initial.id[1]);
var move_bot1 = let2num.indexOf(initial.id[0]);
while (move_right1 < 8 && move_bot1 > 1 && check == 1) {
move_right1++;
move_bot1--;
var selection = document.getElementById(let2num[move_bot1] + move_right1);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}

var check = 1;
var move_right2 = parseInt(initial.id[1]);
var move_top1 = let2num.indexOf(initial.id[0]);
while (move_right2 < 8 && move_top1 < 8 && check == 1) {
move_right2++;
move_top1++;
var selection = document.getElementById(let2num[move_top1] + move_right2);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}



var check = 1;
var move_left1 = parseInt(initial.id[1]);
var move_bot2 = let2num.indexOf(initial.id[0]);
while (move_left1 > 1 && move_bot2 > 1 && check == 1) {
move_left1--;
move_bot2--;
var selection = document.getElementById(let2num[move_bot2] + move_left1);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}

var check = 1;
var move_left2 = parseInt(initial.id[1]);
var move_top2 = let2num.indexOf(initial.id[0]);
while (move_left2 > 1 && move_top2 < 8 && check == 1) {
move_left2--;
move_top2++;
var selection = document.getElementById(let2num[move_top2] + move_left2);
if (selection.children[0].className.split(" ")[0] == your_color) {
check++;
}
else{
selection.style.border = "5px solid green"
if (selection.children[0].className != "empty"){check++;}
}
}
}
//queen//
board.removeEventListener("click", red_selector)
board.addEventListener("click", move.bind(self, initial), {once: true})
board.addEventListener("click", red_selector)
}

function red_selector(){
clicked_case = query_case(event.target)
if (clicked_case != "b") {
Array.from(document.getElementsByClassName("chess")).forEach((item) => {item.style.border = "0px solid red"
})
document.getElementById(clicked_case.id).style.border = "5px solid red"
}
if (turn == "your_turn") {
show_possible_movements(clicked_case)
}
if (document.getElementsByClassName("pseudo")[0] != undefined) {
pseudo_case = document.getElementsByClassName("pseudo")[0]
classname = pseudo_case.className.split(" ")
classname.shift()
pseudo_case.className = classname.join(" ")
}
}
board.addEventListener("click", red_selector)

setInterval(function() {
req = new XMLHttpRequest()
req.open("POST", ip)
req.onload = function() {
if (req.responseText != "/" && req.responseText != "") {
response = req.responseText.split("->")
initial = document.getElementById(response[0])
destination = document.getElementById(response[1])
destination.innerHTML = initial.innerHTML
initial.innerHTML = "<div class='empty'>"
turn = "your_turn"
}
else {
among = req.responseText
}
}
req.send(["waitForMove%" + id])
}, 1000)
</script>
</html>
